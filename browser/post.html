<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zurus06.NAT Post</title>
  <link rel="stylesheet" href="post.css" />
</head>
<body>
  <header>
    <h1>Zurus06.NAT Posts</h1>
    <nav>
        <a href="index.html">Home</a>
        <a href="dashboard.html">Dashboard</a>
        <a href="signin.html">Login</a>
    </nav>
  </header>
  <div class="container" id="postContainer"></div>

  <script>
    async function loadPost() {
      const params = new URLSearchParams(window.location.search);
      const postId = parseInt(params.get("id"));
      const post = await fetch(`http://localhost:5245/posts/${postId}`)
        .then(res => res.json())
        .catch(() => null);

      console.log(post);
      
      const container = document.getElementById("postContainer");

      if (post) {
        let html = `<h1>${post.caption}</h1><div class="intro">${post.intro}</div>`;

        post.contents.forEach(item => {
          if (item.$type === "text") {
            html += `<div class="content-text">${item.content}</div>`;
          } else if (item.$type === "image") {
            html += `
              <div class="image-box">
                <img src="${item.imgLink}" alt="${item.content}" />
                <div class="caption">${item.content}</div>
              </div>
            `;
          }
        });

        html += `<a href="posts.html" class="back-btn">‚Üê Back to Posts</a>`;
        container.innerHTML = html;
      } else {
        container.innerHTML = "<h2>Post not found</h2>";
      }
    }

    loadPost();
  </script>
</body>
</html>